{% extends 'base.html.twig' %}

{% block title %}–†–µ–∑—É–ª—Ç–∞—Ç–∏ –∑–∞ "{{ query }}" - –ü—Ä–æ–º–æ—Ü–∏–∏ –∏ –û—Ñ–µ—Ä—Ç–∏{% endblock %}

{% block body %}
<div class="container mt-4">
    <div class="row mb-4">
        <div class="col-12">
            <h1 class="display-6 fw-bold text-center mb-2">
                üîç –†–µ–∑—É–ª—Ç–∞—Ç–∏ –∑–∞ "<span class="text-primary">{{ query }}</span>"
            </h1>
            <p class="text-center text-muted">
                –ù–∞–º–µ—Ä–µ–Ω–∏ {{ reviews.getTotalItemCount }} –ø—Ä–æ–¥—É–∫—Ç–∞
            </p>
        </div>
    </div>

    {% if reviews|length > 0 %}
        <div class="row g-4">
            {% for review in reviews %}
                <div class="col-md-6 col-lg-3">
                    <div class="card h-100 shadow-sm border-0 position-relative overflow-hidden"
                         style="border-radius: 16px; transition: all 0.3s ease;">
                        {% if review.badge %}
                            <span class="badge bg-danger position-absolute top-0 start-0 m-2 px-3 py-2"
                                  style="z-index: 10; font-size: 0.75rem; border-radius: 8px;">
                                {{ review.badge }}
                            </span>
                        {% endif %}

                        <div class="card-img-top-wrapper" style="height: 200px; overflow: hidden; background: #f8f9fa;">
                            <img src="{{ review.imageUrl ?: 'https://via.placeholder.com/300x200?text=No+Image' }}"
                                 class="card-img-top" alt="{{ review.title }}"
                                 style="width: 100%; height: 100%; object-fit: cover;">
                        </div>

                        <div class="card-body d-flex flex-column">
                            <h5 class="card-title fw-bold mb-2" style="font-size: 0.95rem; line-height: 1.3;">
                                {{ review.title|length > 60 ? review.title|slice(0, 60) ~ '...' : review.title }}
                            </h5>

                            <div class="mb-2">
                                {% for i in 1..5 %}
                                    <i class="bi bi-star{{ i <= review.rating ? '-fill' : '' }} text-warning"></i>
                                {% endfor %}
                                <span class="text-muted ms-1" style="font-size: 0.85rem;">({{ review.rating }}/5)</span>
                            </div>

                            <div class="d-flex justify-content-between align-items-center mb-3">
                                <span class="fw-bold text-success" style="font-size: 1.5rem;">{{ review.price }} –ª–≤.</span>
                            </div>

                            <div class="mt-auto">
                                <a href="{{ path('app_review_show', {'slug': review.slug}) }}"
                                   class="btn btn-outline-primary btn-sm w-100 mb-2"
                                   style="border-radius: 10px;">
                                    <i class="bi bi-eye"></i> –ü—Ä–æ—á–µ—Ç–∏ –†–µ–≤—é
                                </a>
                                <a href="{{ path('app_buy_redirect', {'id': review.id}) }}"
                                   class="btn btn-success btn-sm w-100"
                                   style="border-radius: 10px; font-weight: 700;"
                                   target="_blank" rel="noopener">
                                    <i class="bi bi-cart-plus"></i> –ö—É–ø–∏ –°–µ–≥–∞
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>

        <div class="d-flex justify-content-center mt-5">
            {{ knp_pagination_render(reviews) }}
        </div>
    {% else %}
        <div class="text-center py-5">
            <div class="mb-4">
                <i class="bi bi-search" style="font-size: 4rem; color: #cbd5e0;"></i>
            </div>
            <h3 class="text-muted">–ù—è–º–∞ –Ω–∞–º–µ—Ä–µ–Ω–∏ —Ä–µ–∑—É–ª—Ç–∞—Ç–∏ –∑–∞ "{{ query }}"</h3>
            <p class="text-muted">–û–ø–∏—Ç–∞–π—Ç–µ —Å —Ä–∞–∑–ª–∏—á–Ω–∏ –∫–ª—é—á–æ–≤–∏ –¥—É–º–∏ –∏–ª–∏ —Ä–∞–∑–≥–ª–µ–¥–∞–π—Ç–µ <a href="{{ path('app_home') }}">–≤—Å–∏—á–∫–∏ –æ—Ñ–µ—Ä—Ç–∏</a>.</p>
        </div>
    {% endif %}
</div>

<style>
    .card:hover {
        transform: translateY(-8px);
        box-shadow: 0 12px 24px rgba(0,0,0,0.15) !important;
    }

    .pagination {
        gap: 8px;
    }

    .pagination .page-link {
        border-radius: 10px;
        border: 1px solid #e2e8f0;
        color: #4a5568;
        font-weight: 600;
    }

    .pagination .page-item.active .page-link {
        background: #667eea;
        border-color: #667eea;
    }
</style>
{% endblock %}
